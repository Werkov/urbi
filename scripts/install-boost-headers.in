#!/bin/sh

builddir="@builddir@"
prefix="@prefix@"
build="@build@"
host="@host@"

# First we must figure out where they are. If they were found in a
# standard include directory, no variable will tell us that.  So go
# the configure way and ask the compiler.
make -C $builddir/src find-boost.ii
incline=$(perl -n \
    -e 'if (/^#.*"(.*).foreach.hpp"/)
	{
	  print "$1\n";
	  exit 0;
	}' "$builddir/src/find-boost.ii"
)

case $build:$host in
  (*cygwin:*) incline=$(cygpath  -u "$incline");;
  (*:*mingw32) incline=$(winepath -u "$incline");;
esac

# Ensure we got it right.
if test ! -f  "$incline"/version.hpp; then
  echo >&2 "failed to find boost include directory, got '$incline'"
  exit 1
fi

# Symlinks.
incline=$(perl -mCwd -e 'print Cwd::realpath($ARGV[0]), "\n";' -- "$incline")

cp -pRP "$incline" "$DESTDIR$prefix/include"

# Fix rights: the owner is allowed to change the headers.
chmod -R u+w "$DESTDIR$prefix/include"
