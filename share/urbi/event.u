// Completion of events code

do Event
{
  function init()
  {
    var self.pubsub = PubSub.new
  };

  function 'emit'
  {
    pubsub.publish(call.evalArgs) |
    void
  };

  function onEvent(code)
  {
    var id = pubsub.subscribe |
    for| (var instances: alive)
      code(instances.values) |
    while|(true)
      for| (var payload: pubsub.getAll(id))
        code(payload)
  };
};