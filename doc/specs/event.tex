\section{Event}

An \dfn{event} can be ``emitted'' and ``caught'', or ``sent'' and
``received''.  See also \autoref{sec:tut:events}.

\subsection{Prototypes}
\begin{refObjects}
\item[Object]
\end{refObjects}

\subsection{Examples}

There are several examples of uses of events in the documentation of
event-based constructs.  See \lstinline{at} (\autoref{sec:lang:at}),
\lstinline{waituntil} (\autoref{sec:lang:waituntil}),
\lstinline{whenever} (\autoref{sec:lang:whenever}), and so forth.  The
tutorial chapter about event-based programming contains other
examples, see \autoref{sec:tut:event-prog}.

\subsection{Construction}

An \lstinline{Event} is created like any other object, without
arguments.

\begin{urbiscript}[firstnumber=1]
var e = Event.new;
[00000001] Event_0x9ad8118
\end{urbiscript}

\subsection{Slots}
\begin{urbiscriptapi}
\item[asEvent]
  Return \lstinline|this|.

\item \lstinline|'emit'|\\
  Throw an \lstinline|Event|. This function is called by the bang
  operator.  It takes any number of arguments, passed to the receiver
  when the event is caught. An event can also be emitted for a certain
  duration using \lstinline|~|.  The execution of \lstinline|at|
  clauses etc., is asynchronous: the control flow might be released by
  the \lstinline|emit| call before all the watchers have finished
  their execution.

\item[onSubscribe]
  This slot is not set by default. You can optionnaly assign an event
  to it. In this case, onSubscribe is triggered each time some code
  starts watching this event (by setting up an \lstinline|at| or
  a \lstinline|waituntil| on it for instance).

  Throw a synchronized event. This call awaits that all functions that
  have to react to this event have returned.  This function can have
  the same arguments as \lstinline|emit|.

\item[trigger]
  This function is used to launch an event during an unknown amount of
  time. Calling this function launches and keeps the event triggered
  and returns an object whose \lstinline|stop| method stops launching
  the event.

\item \lstinline,||(\var{other}),\\
  Logical or on events: a new Event that triggers whenever \var{this}
  or \var{other} triggers.

\begin{urbiscript}
var e1 = Event.new;
[00000001] Event_0xADDR
var e2 = Event.new;
[00000002] Event_0xADDR
var e_or = e1 || e2;
[00000003] Event_0xADDR
at (e_or?)
  echo("!");
e1!;
[00000004] *** !
e2!;
[00000005] *** !
\end{urbiscript}

\end{urbiscriptapi}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../urbi-sdk"
%%% ispell-dictionary: "american"
%%% ispell-personal-dictionary: "../urbi.dict"
%%% End:
