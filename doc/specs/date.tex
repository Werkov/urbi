%% Copyright (C) 2009-2010, Gostai S.A.S.
%%
%% This software is provided "as is" without warranty of any kind,
%% either expressed or implied, including but not limited to the
%% implied warranties of fitness for a particular purpose.
%%
%% See the LICENSE file for more information.

\section{Date}

This class is meant to record dates in time.
\experimental{}

\subsection{Prototypes}
\begin{refObjects}
\item[Orderable]
\item[Comparable]
\end{refObjects}

\subsection{Construction}

Without argument, newly constructed dates refer to the \dfn{epoch} (see
\refSlot{epoch}).

\begin{urbiscript}[firstnumber=1]
Date.new;
[00000001] 1970-01-01 01:00:00
\end{urbiscript}

With a numeric argument \var{s}, refers to the date that is \var{s}
seconds after the epoch.

\begin{urbiscript}
Date.new(1234567890);
[00023593] 2009-02-14 00:31:30
\end{urbiscript}

With a string argument \var{d}, refers to the date contained in \var{d}.
The string should be formatted as \samp{\var{yyyy}-\var{mm}-\var{dd}
    \var{hh}:\var{mn}:\var{ss}} (see \refSlot{asString}). \var{mn}
and \var{ss} are optional. If the block \samp{\var{hh}:\var{mn}:\var{ss}}
is absent, the behavior is undefined.


\begin{urbiscript}
Date.new("2003-10-10 20:10:50");
[00086457] 2003-10-10 20:10:50
Date.new("2003-10-10 20:10");
[00091439] 2003-10-10 20:10:00
Date.new("2003-10-10 20");
[00094386] 2003-10-10 20:00:00
\end{urbiscript}

If you create a date with a numeric argument which cannot be interpreted as
a date you should get an error message warning you that the value cannot be
converted into a integer

\begin{urbiscript}
Date.new(0.1);
[00095042:error] !!! new: bad numeric conversion: overflow or non empty fractional part: 0.1
\end{urbiscript}

\subsection{Slots}

\begin{urbiscriptapi}
\item \lstinline|+(\var{that})|\\
  Return the date which is corresponds to waiting \refObject{Duration}
  \var{that} after \this.
\begin{urbiassert}
Date.new(1000) + Duration.new(100) == Date.new(1100);
Date.new(1000) + Duration.new(-100) == Date.new(900);
\end{urbiassert}

\item \lstinline|-(\var{that})|\\
  Compute the difference between two dates.  Return a
  \refObject{Duration}.
\begin{urbiassert}
Date.new(100) - Date.new(0) == Duration.new(100);
Date.new(0) - Date.new(100) == Duration.new(-100);
\end{urbiassert}

\item \lstinline|==(\var{that})|\\
  Equality test.
\begin{urbiassert}
Date.new(11223344) == Date.new(11223344);
Date.new(11111111) != Date.new(22222222);
\end{urbiassert}

\item \lstinline|<(\var{that})|\\
  Order comparison.
\begin{urbiassert}
Date.new(11111111) < Date.new(22222222);
\end{urbiassert}

\item[asFloat]
  Give the numeric value of the date that refers to the date that is \var{s}
seconds after the epoch.
\begin{urbiassert}
Date.new("2002-01-20 23:59:59").asFloat == 1011567599;
\end{urbiassert}

\item[asString]
  Present as \samp{\var{yyyy}-\var{mm}-\var{dd}
    \var{hh}:\var{mn}:\var{ss}} where \var{yyyy} is the four-digit
  year, \var{mm} the two-digit month (from 1 to 12), \var{dd} the
  two-digit day in the month (from 1 to 31), \var{hh} the two-digit
  hour (from 0 to 23), \var{mn} the two-digit number of minutes in the
  hour (from 0 to 59), and \var{ss} the two-digit number of seconds in
  the minute (from 0 to 59).
\begin{urbiassert}
Date.new(1234567890).asString == "2009-02-14 00:31:30";
\end{urbiassert}

\item[epoch]
  A fixed value, the ``origin of times'': January 1st 1970, at
  midnight.
\begin{urbiassert}
Date.epoch == Date;

Date.epoch == Date.new(0);
Date.epoch == Date.new();
\end{urbiassert}

\item[now] The current date.
\begin{urbiunchecked}
Date.now;
[00000000] 2012-03-02 15:31:42
\end{urbiunchecked}

\item[timestamp] Synonym for \refSlot{asFloat}

\end{urbiscriptapi}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../urbi-sdk"
%%% ispell-dictionary: "american"
%%% ispell-personal-dictionary: "../urbi.dict"
%%% fill-column: 76
%%% End:
