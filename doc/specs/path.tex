\section{Path}

A \dfn{Path} points to a file system entity (directory, file and so
forth).

\subsection{Prototypes}
\begin{itemize}
\item \refObject{Comparable}
\item \refObject{Orderable}
\end{itemize}

\subsection{Construction}

A \lstinline|Path| is contructed with the string that points to the
file system entity. This path can be relative or absolute.

\begin{urbiscript}[firstnumber=1]
Path.new("/path/file.u");
[00000001] Path("/path/file.u")
\end{urbiscript}

Some minor simplifications are made, such as stripping useless
\file{./} occurrences.

\begin{urbiscript}[firstnumber=last]
Path.new("././///.//foo/");
[00000002] Path("foo")
\end{urbiscript}

\subsection{Slots}
\begin{itemize}
\item \lstinline|absolute|\\
  Whether \lstinline|this| is absolute.
\begin{urbiassert}[firstnumber=last]
Path.new("/abs/path").absolute;
!Path.new("rel/path").absolute;
\end{urbiassert}

\item \lstinline|asList|\\
  List of names used in path (directories and possibly file), from
  bottom up. There is no difference between relative path and absolute
  path.
\begin{urbiassert}[firstnumber=last]
Path.new("/path/to/file.u").asList == ["path", "to", "file.u"];
Path.new("/path").asList           == Path.new("path").asList;
\end{urbiassert}

\item \lstinline|asPrintable|\\
\begin{urbiassert}[firstnumber=last]
Path.new("file.txt").asPrintable == "Path(\"file.txt\")";
\end{urbiassert}

\item \lstinline|asString|\\
  The name of the file.
\begin{urbiassert}[firstnumber=last]
Path.new("file.txt").asString == "file.txt";
\end{urbiassert}

\item \lstinline|basename|\\
  Base name of the path.
\begin{urbiassert}[firstnumber=last]
Path.new("/absolute/path/file.u").basename == "file.u";
Path.new("relative/path/file.u").basename  == "file.u";
\end{urbiassert}

\item \lstinline|cd|\\
  Change current working directory to \lstinline|this|. Return the new
  current working directory as a \lstinline|Path|.

\item \lstinline|cwd|\\
  The current working directory.
% We used to write
% assert(Path.new("/").cd == Path.new("/"));
% assert(Path.cwd         == Path.new("/"));
% which is wrong on Windows, because cwd (like cd) returns Z:/ instead
% of /.
\begin{urbiscript}[firstnumber=last]
{
  // Save current directory.
  var pwd = Path.cwd|
  // Go into ``/''.
  var root = Path.new("/").cd;
  // Current working directory is ``/''.
  assert(Path.cwd == root);
  // Go back to the directory we were in.
  assert(pwd.cd == pwd);
};
\end{urbiscript}

\item \lstinline|dirname|\\
  Directory name of the path.
\begin{urbiassert}[firstnumber=last]
Path.new("/abs/path/file.u").dirname == Path.new("/abs/path");
Path.new("rel/path/file.u").dirname  == Path.new("rel/path");
\end{urbiassert}

\item \lstinline|exists|\\
  Whether something (a file, a directory, \ldots) exists where
  \lstinline|this| points to.
\begin{urbiassert}[firstnumber=last]
Path.cwd.exists;
Path.new("/").exists;
!Path.new("/this/path/does/not/exists").exists;
\end{urbiassert}

\item \lstinline|isDir|\\
  Whether \lstinline|this| is a directory.
\begin{urbiassert}[firstnumber=last]
Path.cwd.isDir;
\end{urbiassert}

\item \lstinline|isReg|\\
  Whether \lstinline|this| is a regular file.
\begin{urbiassert}[firstnumber=last]
!Path.cwd.isReg;
\end{urbiassert}

\item \lstinline|open|\\
  Open \lstinline|this|. Return either a \dfn{Directory} or a
  \dfn{File} according the type of \lstinline|this|. See
  \refObject{File} and \refObject{Directory}.

\item \lstinline|readable|\\
  Whether \lstinline|this| is readable.
\begin{urbiassert}[firstnumber=last]
Path.new(".").readable;
\end{urbiassert}

\item \lstinline|writable|\\
  Whether \lstinline|this| is writable.
\begin{urbiassert}[firstnumber=last]
Path.new(".").writable;
\end{urbiassert}

\item \lstinline|'/'(\var{rhs})|\\
  Create a new \dfn{Path} that is the concatenation of
  \lstinline|this| and \lstinline|\var{rhs}|. \lstinline|\var{rhs}|
  can be a \dfn{Path} or a \dfn{String} and cannot be absolute.
\begin{urbiscript}[firstnumber=last]
assert(Path.new("/con/ca") / Path.new("te/na/tion")
       == Path.new("/con/ca/te/na/tion"));
Path.cwd / Path.new("/tmp/foo");
[00000003:error] !!! /: Rhs of concatenation is absolute: /tmp/foo
\end{urbiscript}

\item \lstinline|'=='(\var{that})|\\
  Same as comparing the string versions of \lstinline|this| and
  \var{that}.  Beware that two paths may be different and point to the
  very same location.
\begin{urbiassert}[firstnumber=last]
  Path.new("/a")  == Path.new("/a");
!(Path.new("/a")  == Path.new("a")  );
\end{urbiassert}

\item \lstinline|'<'(\var{that})|\\
  Same as comparing the string versions of \lstinline|this| and
  \var{that}.
\begin{urbiassert}[firstnumber=last]
  Path.new("/a")   < Path.new("/a/b");
!(Path.new("/a/b") < Path.new("/a")  );
\end{urbiassert}

\end{itemize}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../urbi-sdk"
%%% ispell-personal-dictionary: "../urbi.dict"
%%% End:
