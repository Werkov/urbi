\chapter{Programs}
\label{sec:tools}

\section{\command{urbi} --- Running an Urbi Server}
\label{sec:tools:urbi}

The \command{urbi} program launches an \urbi server, for either batch,
interactive, or network-based executions.  It is subsumed by, but
simpler to use than, \command{urbi-launch}
(\autoref{sec:tools:urbi-launch}).

\subsection{Options}

\paragraph{Tuning}
\begin{options}
\item[-s, --stack-size=\var{size}] set the coroutine \dfn{stack size}.
  The unit of \var{size} is KB; it defaults to 128.

  This option should not be needed unless you have ``stack exhausted''
  messages from \command{urbi} in which case you should try
  \option{--stack-size=512} or more.

  Alternatively you can define the environment variable
  \code{URBI\_STACK\_SIZE}.  The option \option{--stack-size} has
  precedence over the \code{URBI\_STACK\_SIZE}.
\end{options}

\paragraph{Networking}
\begin{options}
\item[-H, --host=\var{address}] Set the \var{address} on which network
  connections are listened to.  Typical values of \var{address}
  include:
  \begin{description}
  \item[localhost] only local connections are allowed (no other
    computer can reach this server).
  \item[127.0.0.1] same as \code{localhost}.
  \item[0.0.0.0] any IP v4 connection is allowed, including from
    remote computers.
  \end{description}
  Defaults to \code{0.0.0.0}.
\item[-P, --port=\var{port}] Set the port to listen incoming
  connections to.  If \var{port} is \code{-1}, no networking.  If
  \var{port} is \code{0}, then the system will chose any available
  port (see \option{--port-file}).  Defaults to \code{-1}.
\item[-w, --port-file=\var{file}] When the system is up and running,
  and when it is ready for network connections, create the file named
  \var{file} which contains the number of the port the server listens
  to.
\end{options}


\paragraph{Execution}
\begin{options}
\item[-e, --expression=\var{exp}] send the \us expression \var{exp}.
  No separator is added, you have to pass yours.
\item[-f, --file=\var{file}] send the contents of the file \var{file}.
  No separator is added, you have to pass yours.
\item[-i, --interactive] start an interactive session.
\end{options}

The options \option{-e}, \option{-f} accumulate, and are run in the
same \refObject{Lobby} as \option{-i} if used.  In other words, the
following session is valid:

\begin{shell}
# Create a file "two.u".
$ echo "var two = 2;" >two.u
# urbi -e 'var one = 1;' -f two.u -i
[00000000] 1
[00000000] 2
one + two;
[00000000] 3
\end{shell}%$

\section{\command{urbi-launch} --- Running a UObject}
\label{sec:tools:urbi-launch}

The \command{urbi-launch} program launches an \urbi system.  It is
more general than \command{urbi} (\autoref{sec:tools:urbi}):
everything \command{urbi} can do, \command{urbi-launch} can do it too.

\command{urbi-launch} launches UObjects, either in plugged-in mode, or
in remote mode.  Since UObjects can also accept options, the command
line features two parts, separated by \samp{--}:

\begin{shell}
urbi-launch [\var{urbi-launch-option}...] \var{module}... [-- \var{module-option}...]
\end{shell}

\paragraph{Urbi-launch options}
\begin{options}
\item[-h, --help] display the help message and exit successfully.
\item[--version] display version information and exit successfully.
\item[-c, --customize=\var{file}] start the \urbi server in
  \var{file}.  This option is mostly for developpers.
\item[-d, --debug=\var{level}] Set the verbosity level of traces.
  This option is mostly for developpers, but it is very useful when
  tracking problems such as a UObject that fails to load properly.
  Valid values for \var{level} are, in increasing verbosity order:
  \begin{enumerate}
  \item \code{NONE}, no log messages at all.
  \item \code{LOG}, the default value.
  \item \code{TRACE}
  \item \code{DEBUG}
  \item \code{DUMP}, maximum verbosity.
  \end{enumerate}
\end{options}

\paragraph{Mode selection}
\begin{options}
\item[-p, --plugin] attach the \var{module} onto a currently running
  \urbi server (identified by \var{host} and \var{port}).  This is
  equivalent to running \lstinline|loadModule("\var{module}")| on the
  corresponding server.

\item[-r, --remote] run the \var{modules} as separated processes,
  connected to a running Urbi server (identified by \var{host} and
  \var{port}) via network connection.

\item[-s, --start] Start an Urbi server with plugged-in \var{modules}.
\end{options}

\paragraph{Networking}
\command{urbi-launch} supports the same networking options
(\option{--host}, \option{--port}, \option{--port-file}) as
\command{urbi}, see \autoref{sec:tools:urbi}.



%%% Local Variables:
%%% mode: latex
%%% TeX-master: "urbi-specs"
%%% End:
